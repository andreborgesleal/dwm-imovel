@model IEnumerable<DWM.Models.Repositories.EsteiraViewModel>
@{
    Layout = null;
}
@Html.Partial("_alerts")
<div class="panel panel-success">
    @Html.Hidden("esteiraId", Model.FirstOrDefault().esteiraId)
    <div class="panel-heading">
        <h3 class="panel-title">Esteira de Aprovação</h3>
    </div>
    <div class="panel-body">
    </div>
    <table class="table table-hover table-responsive">
        <thead>
            <tr>
                <th>Início</th>
                <th>Etapa</th>
            </tr>
        </thead>

        <tbody>
            @foreach (DWM.Models.Repositories.EsteiraViewModel est in Model)
            {
                var cor = "text-success";
                if (est.ind_aprovacao == "R")
                {
                    cor = "text-danger";
                }
                else if (est.ind_aprovacao == null)
                {
                    cor = "text-primary";
                }

                <tr>
                    <td>
                        <h4 class="text-center text-muted">
                            @est.dt_evento.ToString("dd/MM/yyyy")
                        </h4>
                        <h4 class="text-center">
                            @est.dt_evento.ToString("HH:mm")h
                        </h4>
                    </td>
                     
                    @if (@est.ind_aprovacao == null) 
                    {
                        <td>
                            <strong><p class="@cor">@est.descricao_etapa</p></strong>
                            <p>@est.dt_ocorrencia.ToString("dd/MM/yyyy")</p>
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <div class="col-md-9">
                                        <textarea class="form-control" rows="1"></textarea>
                                    </div>
                                        @Html.EditorFor(info => est.dt_ocorrencia, "DATE", new { identificador = "dt_ocorrencia", value = DateTime.Today, readOnly = "false" })
                                </div>
                                <div class="form-group">
                                    <div class="col-md-12">
                                        <button type="submit" class="btn btn-success">Aprovar</button>
                                        <button type="submit" class="btn btn-danger">Reprovar</button>
                                    </div>
                                </div>
                            </form>
                        </td>
                    }
                    else 
                    {
                        <td>
                            <strong><p class="@cor">@est.descricao_etapa</p></strong>
                            <p>@est.dt_ocorrencia.ToString("dd/MM/yyyy")</p>
                            <p>@est.nome</p>
                            <p class="text-muted">@est.observacao</p>
                        </td>
                    }
                </tr>
            }
        </tbody>
    </table>
</div>

